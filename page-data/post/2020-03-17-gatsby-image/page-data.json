{"componentChunkName":"component---src-templates-post-js","path":"/post/2020-03-17-gatsby-image","result":{"data":{"markdownRemark":{"id":"9379739e-d56a-5308-a420-5c297b247001","frontmatter":{"title":"Auto-Optimize Images On MY Gatsby Site","hero":{"id":"77d48d68-5539-5068-913e-ab59111c72d1","childImageSharp":{"id":"1fad9a6b-8583-5d82-aee0-6a8eab4b44a7","fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAECAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHYnYCGH//EABcQAQEBAQAAAAAAAAAAAAAAAAECESD/2gAIAQEAAQUCqnYV5//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAAMBAAAAAAAAAAAAAAAAAABBkSD/2gAIAQEABj8CcHM//8QAGhABAAIDAQAAAAAAAAAAAAAAAQAREDGRUf/aAAgBAQABPyELDm8Ab6pKfcmp/9oADAMBAAIAAwAAABA4D//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABURAQEAAAAAAAAAAAAAAAAAABAh/9oACAECAQE/EIf/xAAcEAEAAgEFAAAAAAAAAAAAAAABABExEHGRweH/2gAIAQEAAT8QQmhi0cxFdh8stXrDGmDaf//Z","aspectRatio":2.3529411764705883,"src":"/static/4cfd27c5bc3d963d7a43b27d9b5c32ce/14b42/gatsby-image.jpg","srcSet":"/static/4cfd27c5bc3d963d7a43b27d9b5c32ce/f836f/gatsby-image.jpg 200w,\n/static/4cfd27c5bc3d963d7a43b27d9b5c32ce/2244e/gatsby-image.jpg 400w,\n/static/4cfd27c5bc3d963d7a43b27d9b5c32ce/14b42/gatsby-image.jpg 800w,\n/static/4cfd27c5bc3d963d7a43b27d9b5c32ce/a7715/gatsby-image.jpg 1000w","sizes":"(max-width: 800px) 100vw, 800px"}}},"date":"2020-03-17","path":"post/2020-03-17-gatsby-image","tags":["learning-to-code","gatsby"]},"html":"<h2>#100DaysOfGatsby Challenge 3</h2>\n<p>Today I followed <a href=\"https://www.gatsbyjs.org/blog/100days/gatsby-image/\">#100DaysOfGatsby Challenge 3</a> to optimize the images on my site. In the beginning, it drove me crazy.</p>\n<p>I structured my code like this at first:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">- content/\n  - posts/\n    - article1.md\n    - article2.md\n- src/\n  - components/\n  - pages/\n    - index.js\n    - about.js\n  - scss/\n  - templates/\n- static/\n  - images/\n    - pic-of-article1.jpg\n    - pic-of-article2.jpg</code></pre></div>\n<p>And the frontmatter in markdown files like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"md\"><pre class=\"language-md\"><code class=\"language-md\"><span class=\"token hr punctuation\">---</span>\n<span class=\"token comment\">&lt;!-- content/posts/article1.md --></span>\ntitle: This is the title of article1\n<span class=\"token title important\">hero: pic-of-article1.jpg\n<span class=\"token punctuation\">---</span></span></code></pre></div>\n<p>The configures in <code>gatsby-config.js</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">module.exports = {\n  plugins: [\n    {\n      resolve: `gatsby-source-filesystem`,\n      options: {\n        name: &#39;posts&#39;,\n        path: `${__dirname}/content/post/`\n      }\n    },\n    {\n      resolve: `gatsby-source-filesystem`,\n      options: {\n        name: &#39;images&#39;,\n        path: `${__dirname}/static/images/`\n      }\n    }\n  ]\n}</code></pre></div>\n<p>I used the plugin <code>gatsby-source-filesystem</code> to sourcing data, and it all worked fine until I started to use <code>gatsby-image</code> to optimize images.</p>\n<p>When I follow the <a href=\"https://www.gatsbyjs.org/docs/working-with-images-in-markdown/\">document</a> to configure <code>gatsby-image</code> I couldn't get the images.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> query <span class=\"token operator\">=</span> graphql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n    query PostContent($pathName: String!) {\n        markdownRemark(frontmatter: { path: { eq: $pathName } }) {\n            frontmatter {\n                title\n                hero {\n                    childImageSharp {\n                        fluid {\n                            ...GatsbyImageSharpFluid\n                        }\n                    }\n                }\n        }\n    }\n</span><span class=\"token template-punctuation string\">`</span></span></code></pre></div>\n<p>The <mark>error</mark> message showed up: </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Field \\&quot;hero\\&quot; must not have a selection since type \\&quot;String\\&quot; has no subfields.</code></pre></div>\n<p>I can't find the right solution for this until I restructured my code as same as in the document. Putting the markdown files in <code>/src/pages/</code> and the images in <code>/src/images/</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">- src/\n  - components/\n  - pages/\n    - index.js\n    - about.js\n    - article1.md\n    - article2.md\n  - scss/\n  - templates/\n  - images/\n    - pic-of-article1.jpg\n    - pic-of-article2.jpg</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"md\"><pre class=\"language-md\"><code class=\"language-md\"><span class=\"token hr punctuation\">---</span>\n<span class=\"token comment\">&lt;!-- src/pages/article1.md --></span>\ntitle: This is the title of article1\n<span class=\"token title important\">hero: ../images/pic-of-article1.jpg\n<span class=\"token punctuation\">---</span></span></code></pre></div>\n<p>Then the hero image automatically attached to the markdown node and everthing works fine!</p>\n<p>I think the right way to do anything is just to follow the documents exactly and change my own habits.</p>\n<h4>Other Reading Materials</h4>\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/54636627/add-imagesharp-as-a-field-to-markdownremark-nodes-not-frontmatter?answertab=votes#tab-top\">Add ImageSharp as a field to MarkdownRemark nodes (not frontmatter)</a></li>\n<li><a href=\"https://dennytek.com/blog/personal-site-with-gatsby-part-5\">Part 5: Adding Thumbnail Images to a Blog List</a></li>\n</ul>"},"site":{"id":"Site","siteMetadata":{"title":"CY Is Here"}}},"pageContext":{"pathName":"post/2020-03-17-gatsby-image","prev":null,"next":{"frontmatter":{"path":"post/100-days-of-gatsby","tags":["learning-to-code","gatsby"],"title":"#100DaysOfGatsby Challenge"}}}}}